<script>
  /**
   * @polymerBehavior CubaEntityEditViewBehavior
   */
  CubaEntityEditViewBehavior = {

    /**
     * Fired when an entity successfully saved.
     *
     * @event commit
     */

    /**
     * Fired when user cancels changes.
     *
     * @event cancel
     */

    /**
     * Fired when when user deletes an entity.
     *
     * @event delete
     * @param {Object} entity The entity to delete
     */

    properties: {
      /**
       * Id of entity that will be loaded
       */
      entityId: {
        type: String,
        observer: '_handleEntityIdChange'
      },
      /**
       * Loaded entity
       *
       * @type {Object}
       */
      entity: {
        type: Object,
        value: function() {
          return {}
        }
      }
    },
    _handleEntityIdChange: function(newValue) {
      this.entity = {};
    },
    _save: function() {
      this.$.form.submit();
    },
    _onSuccess: function() {
      this.fire("commit");
    },
    _onError: function() {
      this.$.errorMessage.show();
    },
    _cancel: function() {
      this.set("serverErrors", {});
      this.fire("cancel");
    },
    _delete: function() {
      this.fire("delete", {entity: this.entity});
    },
    _isInvalid: function(err) {
      return typeof err !== 'undefined';
    }
  }
</script>